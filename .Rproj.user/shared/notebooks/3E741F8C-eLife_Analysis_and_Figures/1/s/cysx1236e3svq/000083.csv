"0","sig_list <- list()"
"0","for(comp in c(""All Men"", ""All Women"", ""Mixed"", ""Uncertain"")) {"
"0","  for(gender_var in c(""ca_gender"", ""fa_gender"", ""la_gender"")) {"
"0","    if (!is.na(comp)) {"
"0","      sub <- subset(elife, initial_decision_made & full_decision_made & composition == comp)[, c(""accepted"", gender_var)]"
"0","      t <- t(table(sub))[1:2,]"
"0","      test = prop.test(t[, 2], rowSums(t))"
"0","      sig_list[length(sig_list) + 1] <- list(test)"
"0","    }"
"0","  }"
"0","}"
"0","sig_df <- data.frame(composition = c(rep(""All Men"", 3), rep(""All Women"", 3), rep(""Mixed"", 3), rep(""Uncertain"", 3)),"
"0","                     author_key = rep(c(""ca_gender"", ""fa_gender"", ""la_gender""), 4),"
"0","                     sig = sapply(sig_list, function(test) { sig2ast(test$p.value)})"
"0",")"
"0","fig4 <- elife %>%"
"0","  filter(initial_decision_made & full_decision_made & !is.na(composition)) %>%"
"0","  mutate(total_submissions = n()) %>%"
"0","  gather(author_key, value = gender, ca_gender, fa_gender, la_gender) %>%"
"0","  filter(gender %in% c(""M"", ""F"")) %>%"
"0","  group_by(composition, author_key, gender) %>%"
"0","  summarize("
"0","    paper_count = n(),"
"0","    accept_count = sum(accepted == TRUE),"
"0","    acceptance_rate = sum(accepted == TRUE) / paper_count,"
"0","    standard_error = sqrt( (acceptance_rate * (1 - acceptance_rate)) / paper_count),"
"0","    lower = acceptance_rate - standard_error,"
"0","    upper = acceptance_rate + standard_error"
"0","  ) %>%"
"0","  ungroup() %>%"
"0","  left_join(sig_df, by = c(""composition"", ""author_key"")) %>%"
"0","  mutate("
"0","    author_key = factor(author_key, labels = c(""ca_gender"" = ""Corresponding"", ""fa_gender"" = ""First"", ""la_gender"" = ""Last""))"
"0","  ) %>%"
"0","  ggplot(aes(x = gender, y = acceptance_rate, fill = gender)) +"
"0","  geom_bar(stat = ""identity"", alpha = 0.8, color = ""black"") +"
"0","  geom_text(aes(y = 0.1, label = paste0(round(acceptance_rate, 3) * 100, ""%"")), size = 2.5, color = ""black"", position = position_dodge(0.87)) +"
"0","  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2, color = ""black"", alpha = 0.8) +"
"0","  geom_text(aes(x = 1.5, y = 0.90, label = sig), color = ""black"") +"
"0","  geom_segment(aes(x = 1, xend = 2, y = ifelse(sig != ""N/A"", 0.8, 1.1), yend = ifelse(sig != ""N/A"", 0.8, 1.1)), color = ""black"") +"
"0","  facet_grid(author_key ~ composition) +"
"0","  ylim(0, 1) +"
"0","  theme_dakota() +"
"0","  theme("
"0","    axis.title.x = element_blank()"
"0","  ) +"
"0","  labs(y = ""Encourage-Acceptance Rate"") +"
"0","  scale_fill_discrete(labels = c(""F"" = ""Female"", ""M"" = ""Male""))"
"2","Column `author_key` joining character vector and factor, coercing into character vector"
"0","  "
"0","fig4"
