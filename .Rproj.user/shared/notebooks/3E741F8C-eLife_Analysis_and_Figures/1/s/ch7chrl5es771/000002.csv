"0","library(ggplot2)"
"0","library(dplyr)"
"0","library(readr)"
"0","library(readxl)"
"0","library(gridExtra)"
"0","library(grid)"
"0","library(tidyr)"
"0","# This function for creating a multiplot grid object with a shared ledend is largely derivied, with a few minor"
"0","# tweaks, from the following blog by Andy Phillips. "
"0","# https://andyphilips.github.io/blog/2017/04/04/single-legend-for-multiple-plots.html"
"0","grid_arrange_shared_legend <- function(..., ncol = length(list(...)), nrow = 1, position = c(""bottom"", ""right""), title = """", plot = T) {"
"0","	plots <- list(...)"
"0","	position <- match.arg(position)"
"0","	g <- ggplotGrob(plots[[1]] + "
"0","	theme(legend.position = position, "
"0","	      legend.title = element_blank()))$grobs"
"0","	legend <- g[[which(sapply(g, function(x) x$name) == ""guide-box"")]]"
"0","	lheight <- sum(legend$height)"
"0","	lwidth <- sum(legend$width)"
"0","	gl <- lapply(plots, function(x) x +"
"0","	theme(legend.position = ""none""))"
"0","	gl <- c(gl, ncol = ncol, nrow = nrow)"
"0","	combined <- switch(position,"
"0","	                   ""bottom"" = arrangeGrob(do.call(arrangeGrob, gl), "
"0","	                      legend,ncol = 1,"
"0","	                      top = textGrob(title,"
"0","	                                     gp=gpar(fontsize=12, "
"0","	                                             fontface = ""bold"", "
"0","	                                             fontfamily = ""Times""),"
"0","	                                     just = ""top""),"
"0","					              heights = unit.c(unit(1, ""npc"") - lheight, lheight)"
"0","					              ),"
"0","					              "
"0","					           ""right"" = arrangeGrob(do.call(arrangeGrob, gl),"
"0","                          legend, "
"0","					                ncol = 2,"
"0","				                  top = textGrob(title,"
"0","                                         gp=gpar(fontsize=12, "
"0","                                                 fontface = ""bold"", "
"0","                                                 fontfamily = ""Times""), "
"0","				                  just = ""top""),"
"0","				                  widths = unit.c(unit(1, ""npc"") - lwidth, lwidth)))"
"0","	if(plot) {"
"0","	  grid.newpage()"
"0","	  grid.draw(combined)  "
"0","	}"
"0","	"
"0","	# return gtable invisibly"
"0","	invisible(combined)"
"0","}"
"0","theme_dakota <- function () { "
"0","    theme_bw(base_size=10, base_family=""Times"") %+replace% "
"0","        theme("
"0","            strip.background = element_blank(),"
"0","            strip.text = element_text(face = ""bold""),"
"0","            plot.title = element_text(size = 11, face = ""bold""),"
"0","            axis.text.x = element_text(size = 9, margin = margin(t = 5, b = 5)),"
"0","            legend.title = element_blank(),"
"0","            legend.position = ""bottom"""
"0","        )"
"0","}"
"0","# converts a provided p-value into a representation that is easier to visualize"
"0","sig2ast <- function(p) { ifelse(p <= 0.0001, ""****"", "
"0","                                ifelse(p <= 0.001, ""***"", "
"0","                                       ifelse(p <= 0.01, ""**"", "
"0","                                              ifelse(p <= 0.05, ""*"", ""ns"")"
"0","                                              )"
"0","                                       )"
"0","                                )"
"0","}"
